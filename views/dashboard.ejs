<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <%- include("./partials/style.ejs") %>
    <title>Dashboard - Appt</title>
</head>
<%- include("./partials/navbar.ejs", {user: user}) %>
<body>
    <div id="dashboard-title">
        <h1>Dashboard</h1>
        <p>Welcome to Appt!</p>
    </div>
    <%- include("./partials/messages.ejs") %>
    <ul class="nav nav-tabs" id="myTab" role="tablist">
        <li class="nav-item">
            <a class="nav-link active" id="my-appointments-tab" data-toggle="tab" href="#my-appointments" role="tab" aria-controls="my-appointments" aria-selected="true">My Appointments</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" id="past-appointments-tab" data-toggle="tab" href="#past-appointments" role="tab" aria-controls="past-appointments" aria-selected="false">Past Appointments</a>
        </li>
        <% if (user.usertype === "serviceprovider") { %>
        <li class="nav-item">
            <a class="nav-link" id="availability-tab" data-toggle="tab" href="#availability" role="tab" aria-controls="availability" aria-selected="false">My Availability</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" id="appointment-types-tab" data-toggle="tab" href="#appointment-types" role="tab" aria-controls="appointment-types" aria-selected="false">Appointment Types</a>
        </li>
        <% } %>
        <li class="nav-item">
            <a class="nav-link" id="my-profile-tab" data-toggle="tab" href="#my-profile" role="tab" aria-controls="my-profile" aria-selected="false">My Profile</a>
        </li>
    </ul>
    <div class="tab-content" id="myTabContent">
        <div class="tab-pane fade show active" id="my-appointments" role="tabpanel" aria-labelledby="my-appointments-tab">
            <%- include("./partials/dashboard/myAppointments.ejs", {user: user}) %>
        </div>
        <div class="tab-pane fade" id="past-appointments" role="tabpanel" aria-labelledby="past-appointments-tab">
            <%- include("./partials/dashboard/past.ejs", {user: user}) %>
        </div>
        <% if (user.usertype === "serviceprovider") { %>
        <div class="tab-pane fade" id="availability" role="tabpanel" aria-labelledby="availability-tab">
            <%- include("./partials/dashboard/availability.ejs", {user: user}) %>
        </div>
        <div class="tab-pane fade" id="appointment-types" role="tabpanel" aria-labelledby="appointment-types-tab">
            <%- include("./partials/dashboard/appointmentTypes.ejs", {user: user}) %>
        </div>
        <% } %>
        <div class="tab-pane fade" id="my-profile" role="tabpanel" aria-labelledby="my-profile-tab">
            <%- include("./partials/dashboard/profile.ejs", {user: user}) %>
        </div>
    </div>
    <script>
        let myAppointmentsTab = document.querySelector("#my-appointments-tab")
        let pastAppointmentsTab = document.querySelector("#past-appointments-tab")
        let availabilityTab = document.querySelector("#availability-tab")
        let appointmentTypesTab = document.querySelector("#appointment-types-tab")
        let myProfileTab = document.querySelector("#my-profile-tab")

        let myAppointmentsContent = document.querySelector("#my-appointments")
        let pastAppointmentsContent = document.querySelector("#past-appointments")
        let availabilityContent = document.querySelector("#availability")
        let appointmentTypesContent = document.querySelector("#appointment-types")
        let myProfileContent = document.querySelector("#my-profile")

        myAppointmentsTab.addEventListener("click", () => {
            
            // myAppointmentsContent.classList.add("show")
            // myAppointmentsContent.classList.add("active")
            // pastAppointmentsContent.classList.remove("show")
            // pastAppointmentsContent.classList.remove("active")
            // availabilityContent.classList.remove("show")
            // availabilityContent.classList.remove("active")
            // appointmentTypesContent.classList.remove("show")
            // appointmentTypesContent.classList.remove("active")
            // myProfileContent.classList.remove("show")
            // myProfileContent.classList.remove("active")
            // myAppointmentsContent.style.display = "block"
            // pastAppointmentsContent.style.display = "none"
            // availabilityContent.style.display = "none"
            // appintmentTypesContent.style.display = "none"
            // myProfileContent.style.display = "none"
        })

        pastAppointmentsTab.addEventListener("click", () => {
            pastAppointmentsContent.classList.add("show")
            pastAppointmentsContent.classList.add("active")
            myAppointmentsContent.classList.remove("show")
            myAppointmentsContent.classList.remove("active")
            availabilityContent.classList.remove("show")
            availabilityContent.classList.remove("active")
            appointmentTypesContent.classList.remove("show")
            appointmentTypesContent.classList.remove("active")
            myProfileContent.classList.remove("show")
            myProfileContent.classList.remove("active")
            // myAppointmentsContent.style.display = "none"
            // pastAppointmentsContent.style.display = "block"
            // availabilityContent.style.display = "none"
            // appintmentTypesContent.style.display = "none"
            // myProfileContent.style.display = "none"
        })

        availabilityTab.addEventListener("click", () => {
            availabilityContent.classList.add("show")
            availabilityContent.classList.add("active")
            myAppointmentsContent.classList.remove("show")
            myAppointmentsContent.classList.remove("active")
            pastAppointmentsContent.classList.remove("show")
            pastAppointmentsContent.classList.remove("active")
            appointmentTypesContent.classList.remove("show")
            appointmentTypesContent.classList.remove("active")
            myProfileContent.classList.remove("show")
            myProfileContent.classList.remove("active")
            // myAppointmentsContent.style.display = "none"
            // pastAppointmentsContent.style.display = "none"
            // availabilityContent.style.display = "block"
            // appintmentTypesContent.style.display = "none"
            // myProfileContent.style.display = "none"
        })

        appointmentTypesTab.addEventListener("click", () => {
            appointmentTypesContent.classList.add("show")
            appointmentTypesContent.classList.add("active")
            myAppointmentsContent.classList.remove("show")
            myAppointmentsContent.classList.remove("active")
            pastAppointmentsContent.classList.remove("show")
            pastAppointmentsContent.classList.remove("active")
            availabilityContent.classList.remove("show")
            availabilityContent.classList.remove("active")
            myProfileContent.classList.remove("show")
            myProfileContent.classList.remove("active")
            // myAppointmentsContent.style.display = "none"
            // pastAppointmentsContent.style.display = "none"
            // availabilityContent.style.display = "none"
            // appintmentTypesContent.style.display = "block"
            // myProfileContent.style.display = "none"
        })

        myProfileTab.addEventListener("click", () => {
            myProfileContent.classList.add("show")
            myProfileContent.classList.add("active")
            myAppointmentsContent.classList.remove("show")
            myAppointmentsContent.classList.remove("active")
            pastAppointmentsContent.classList.remove("show")
            pastAppointmentsContent.classList.remove("active")
            availabilityContent.classList.remove("show")
            availabilityContent.classList.remove("active")
            appointmentTypesContent.classList.remove("show")
            appointmentTypesContent.classList.remove("active")
            // myAppointmentsContent.style.display = "none"
            // pastAppointmentsContent.style.display = "none"
            // availabilityContent.style.display = "none"
            // appintmentTypesContent.style.display = "none"
            // myProfileContent.style.display = "block"
        })

        flatpickr(".availability-time-start", {
            enableTime: true,
            noCalendar: true,
            time_24hr: false,
            dateFormat: "h:i K",
            minuteIncrement: 15
        })
        flatpickr(".availability-time-end", {
            enableTime: true,
            noCalendar: true,
            time_24hr: false,
            dateFormat: "h:i K",
            minuteIncrement: 15
        })
        flatpickr(".unavailable-dates", {
            minDate: "today",
            mode: "multiple",
            dateFormat: "m-d-Y"
        })
    </script>
</body>
</html>